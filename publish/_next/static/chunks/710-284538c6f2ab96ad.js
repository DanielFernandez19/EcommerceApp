"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[710],{353:(e,t,a)=>{a.d(t,{l:()=>n});var r=a(5155);function n(e){let{id:t,name:a,label:n,value:o,options:s,onChange:i,required:l=!1,disabled:c=!1,loading:d=!1,error:u=null,className:m=""}=e,p=null!=t?t:a;return(0,r.jsxs)("div",{className:"flex flex-col gap-1 ".concat(m),children:[n&&(0,r.jsxs)("label",{htmlFor:p,className:"text-sm font-medium text-gray-300",children:[n," ",l?(0,r.jsx)("span",{className:"text-violet-400",children:"*"}):null]}),(0,r.jsxs)("select",{id:p,name:a,value:o,onChange:i,disabled:c||d,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all disabled:opacity-50",children:[(0,r.jsx)("option",{value:"",className:"bg-gray-700",children:d?"Cargando...":"Seleccione..."}),s.map(e=>(0,r.jsx)("option",{value:e.id,className:"bg-gray-700",children:e.name},String(e.id)))]}),u?(0,r.jsx)("p",{role:"alert",className:"text-sm text-red-400 mt-1",children:u}):null]})}},3741:(e,t,a)=>{a.d(t,{$:()=>n});var r=a(5155);let n=a(2115).forwardRef((e,t)=>{let{children:a,type:n="button",variant:o="primary",size:s="md",disabled:i=!1,loading:l=!1,onClick:c,className:d="",fullWidth:u=!1,...m}=e,p="\n      ".concat("font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2","\n      ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 disabled:bg-blue-300",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500 disabled:bg-gray-100",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 disabled:bg-red-300",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500 disabled:text-gray-400"}[o],"\n      ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[s],"\n      ").concat(u?"w-full":"","\n      ").concat(d,"\n      ").concat(i||l?"cursor-not-allowed opacity-50":"","\n    ");return(0,r.jsx)("button",{ref:t,type:n,disabled:i||l,onClick:c,className:p.trim(),...m,children:l?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]}):a})});n.displayName="Button"},3915:(e,t,a)=>{a.d(t,{p:()=>n});var r=a(5155);let n=a(2115).forwardRef((e,t)=>{let{id:a,name:n,label:o,value:s,placeholder:i,type:l="text",onChange:c,onBlur:d,required:u=!1,disabled:m=!1,error:p=null,className:h="",autoComplete:g,...y}=e,b=null!=a?a:n;return(0,r.jsxs)("div",{className:"flex flex-col gap-1 ".concat(h),children:[o&&(0,r.jsxs)("label",{htmlFor:b,className:"text-sm font-medium text-white",children:[o," ",u&&(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{ref:t,id:b,name:n,type:l,value:s,placeholder:i,autoComplete:g,onChange:e=>c(e.target.value),onBlur:d,required:u,disabled:m,className:"\n            px-3 py-2 border rounded-lg text-sm\n            focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent\n            disabled:opacity-50 disabled:cursor-not-allowed\n            bg-gray-700 text-white border-gray-600\n            ".concat(p?"border-red-500 focus:ring-red-500":"border-gray-600","\n          "),...y}),p&&(0,r.jsx)("p",{role:"alert",className:"text-sm text-red-400 mt-1",children:p})]})});n.displayName="Input"},5731:(e,t,a)=>{a.d(t,{Vg:()=>o,uE:()=>n});class r{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="".concat(this.baseURL,"/").concat(e.replace(/^\//,"")),r={...t,headers:{"Content-Type":"application/json",...t.headers}};try{let e=await fetch(a,r),t=await e.json().catch(()=>null);if(!e.ok)throw{status:e.status,message:(null==t?void 0:t.message)||"HTTP ".concat(e.status),body:t};return t}catch(e){if(e&&"object"==typeof e&&"status"in e)throw e;throw{status:0,message:e instanceof Error?e.message:"Network error"}}}async get(e){return this.request(e,{method:"GET"})}async post(e,t){return this.request(e,{method:"POST",body:JSON.stringify(t)})}async put(e,t){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}async delete(e){return this.request(e,{method:"DELETE"})}constructor(e){this.baseURL=e.replace(/\/$/,"")}}let n=new r("http://localhost:5000/api"),o=e=>n.get(e)},8316:(e,t,a)=>{async function r(){try{let e=await fetch("".concat("http://localhost:5000/api","/products"));return e.ok?await e.json():[]}catch(e){return[]}}async function n(){try{let e=await fetch("".concat("http://localhost:5000/api","/order"));return e.ok?await e.json():[]}catch(e){return[]}}async function o(e){try{let t=await fetch("".concat("http://localhost:5000/api","/order/user/").concat(e));return t.ok?await t.json():[]}catch(e){return[]}}a.d(t,{DD:()=>m,Kv:()=>g,TK:()=>u,Us:()=>h,WF:()=>n,WY:()=>s,bW:()=>d,d$:()=>r,ht:()=>l,iG:()=>p,kg:()=>i,mq:()=>o,xw:()=>c});async function s(e){try{let t=await fetch("".concat("http://localhost:5000/api","/products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t.ok?await t.json():null}catch(e){return null}}async function i(e){try{return(await fetch("".concat("http://localhost:5000/api","/user/CreateUser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok}catch(e){return!1}}async function l(e){try{let t=await fetch("".concat("http://localhost:5000/api","/user/GetAll"));if(!t.ok)return null;return(await t.json()).find(t=>t.email===e)}catch(e){return null}}async function c(e,t){try{return(await fetch("".concat("http://localhost:5000/api","/user/UpdatePass"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({Id:e,newPassword:t})})).ok}catch(e){return!1}}async function d(){try{let e=await fetch("".concat("http://localhost:5000/api","/Products/GetCategories"));return e.ok?await e.json():[]}catch(e){return[]}}async function u(e,t){try{return(await fetch("".concat("http://localhost:5000/api","/user/UpdateUser"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok}catch(e){return!1}}async function m(e){try{return(await fetch("".concat("http://localhost:5000/api","/products/").concat(e),{method:"DELETE"})).ok}catch(e){return!1}}async function p(e,t){try{let a=new FormData;a.append("file",t);let r=await fetch("".concat("http://localhost:5000/api","/products/").concat(e,"/images"),{method:"POST",body:a});return r.ok?await r.json():null}catch(e){return null}}async function h(e){try{return(await fetch("".concat("http://localhost:5000/api","/products/images/").concat(e),{method:"DELETE"})).ok}catch(e){return!1}}async function g(e,t){try{return(await fetch("".concat("http://localhost:5000/api","/order/").concat(e,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok}catch(e){return!1}}},8567:(e,t,a)=>{a.d(t,{p:()=>h});var r=a(5155),n=a(2115),o=a(3915),s=a(3741),i=a(5731),l=a(353);function c(e){let{initialCountryId:t=0,initialProvinceId:a=0,initialCityId:o=0,onCountryChange:s,onProvinceChange:c,onCityChange:d,disabled:u=!1,loading:m=!1,required:p=!1,showLabels:h=!0,className:g="",countryError:y,provinceError:b,cityError:f}=e,x=(0,n.useRef)(t),v=(0,n.useRef)(a);(0,n.useEffect)(()=>{x.current=t},[t]),(0,n.useEffect)(()=>{v.current=a},[a]);let{countries:j,provinces:N,cities:w,loadingCountries:C,loadingProvinces:E,loadingCities:P,error:S,preloadLocation:k}=function(e,t){let[a,r]=(0,n.useState)([]),[o,s]=(0,n.useState)([]),[l,c]=(0,n.useState)([]),[d,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)(!1),[h,g]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=!0;return async function(){u(!0);try{let t=await (0,i.Vg)("Country/GetAll");if(!e)return;r(t)}catch(t){if(!e)return;r([]),b("No se pudieron cargar los pa\xedses")}finally{e&&u(!1)}}(),()=>{e=!1}},[]),(0,n.useEffect)(()=>{if(!e){s([]),c([]);return}let t=!0;return async function(){p(!0);let a="province/GetAllByCountry/".concat(e);try{let e=await (0,i.Vg)(a);if(!t)return;Array.isArray(e)?s(e):(console.error("Invalid provinces data format - expected array, got:",typeof e,e),s([]))}catch(e){if(!t)return;s([]),e&&"object"==typeof e&&"status"in e?console.error("Error loading provinces:",{status:e.status,message:e.message||"No message",body:e.body,endpoint:a}):console.error("Unexpected error loading provinces:",e)}finally{t&&p(!1)}}(),()=>{t=!1}},[e]),(0,n.useEffect)(()=>{if(!t){c([]);return}let e=!0;return async function(){g(!0);try{let a=await (0,i.Vg)("City/GetAllByProvince/".concat(t));if(!e)return;Array.isArray(a)?c(a):(console.error("Invalid cities data format:",a),c([]))}catch(t){if(!e)return;c([]),t&&"object"==typeof t&&"status"in t?console.error("Error loading cities (".concat(t.status,"):"),t.message||"Unknown error",t.body):console.error("Error loading cities:",t)}finally{e&&g(!1)}}(),()=>{e=!1}},[t]);let f=async(e,t,r)=>{console.log("preloadLocation iniciado:",{countryId:e,provinceId:t,cityId:r});try{if(0===a.length){console.log("Esperando carga de pa\xedses...");let e=0;for(;0===a.length&&e<50;)await new Promise(e=>setTimeout(e,100)),e++}if(e&&a.length>0){console.log("Esperando provincias del pa\xeds:",e);let t=0;for(;0===o.length&&t<50;)await new Promise(e=>setTimeout(e,100)),t++;console.log("Provincias cargadas:",o.length)}if(t&&o.length>0){console.log("Esperando ciudades de la provincia:",t);let e=0;for(;0===l.length&&e<50;)await new Promise(e=>setTimeout(e,100)),e++;console.log("Ciudades cargadas:",l.length)}console.log("preloadLocation completado")}catch(e){console.error("Error en preloadLocation:",e)}};return{countries:a,provinces:o,cities:l,loadingCountries:d,loadingProvinces:m,loadingCities:h,error:y,resetProvinces:()=>{s([])},resetCities:()=>{c([])},preloadLocation:f}}(x.current,v.current);return(0,r.jsxs)("div",{className:"space-y-6 ".concat(g),children:[S&&(0,r.jsx)("div",{className:"bg-red-900/20 border border-red-500/50 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-red-400 text-sm",children:S})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)(l.l,{label:h?"Pa\xeds":void 0,name:"country",value:t,options:j.map(e=>({id:e.id,name:e.name})),onChange:e=>{let t=Number(e.target.value)||0;x.current=t,s(t)},loading:C,required:p,disabled:u||m,error:y}),(0,r.jsx)(l.l,{label:h?"Provincia":void 0,name:"province",value:a,options:N.map(e=>({id:e.id,name:e.name})),onChange:e=>{let t=Number(e.target.value)||0;v.current=t,c(t)},loading:E,required:p,disabled:u||m||!t,error:b}),(0,r.jsx)(l.l,{label:h?"Ciudad":void 0,name:"city",value:o,options:w.map(e=>({id:e.id,name:e.name})),onChange:e=>{d(Number(e.target.value)||0)},loading:P,required:p,disabled:u||m||!a,error:f})]})]})}var d=a(927);let u=d.Ik({name:d.Yj().min(1,"El nombre es requerido").trim(),lastName:d.Yj().min(1,"El apellido es requerido").trim(),email:d.Yj().min(1,"El email es requerido").email("El email no es v\xe1lido").trim(),phoneNumber:d.Yj().optional(),billingAddress:d.Yj().optional(),billingAddress2:d.Yj().optional(),postalCode:d.Yj().optional(),idCountry:d.ai().min(1,"Debes seleccionar un pa\xeds").int("El pa\xeds debe ser un n\xfamero entero"),idProvince:d.ai().min(1,"Debes seleccionar una provincia").int("La provincia debe ser un n\xfamero entero"),idCity:d.ai().min(1,"Debes seleccionar una ciudad").int("La ciudad debe ser un n\xfamero entero"),idRole:d.ai().min(1,"Debes seleccionar un rol").int("El rol debe ser un n\xfamero entero")}).extend({password:d.Yj().min(6,"La contrase\xf1a debe tener al menos 6 caracteres").optional()}),m=u.extend({password:d.Yj().min(6,"La contrase\xf1a debe tener al menos 6 caracteres")}),p=u.omit({password:!0});function h(e){var t,a,i;let{user:l,loading:d=!1,onSubmit:u,onCancel:h,submitText:g="Guardar Cambios",cancelText:y="Cancelar",title:b,subtitle:f,showRoleSelector:x=!1,initialRole:v,roleOptions:j=[],children:N,isNewUser:w=!1}=e,C=(null===(t=l.countryDto)||void 0===t?void 0:t.id)||l.idCountry||0,E=(null===(a=l.provinceDto)||void 0===a?void 0:a.id)||l.idProvince||0,P=(null===(i=l.cityDto)||void 0===i?void 0:i.id)||l.idCity||0,[S,k]=(0,n.useState)({name:l.name,lastName:l.lastName||"",email:l.email,password:"",phoneNumber:l.phoneNumber||"",billingAddress:l.billingAddress||"",postalCode:l.postalCode||""}),[A,T]=(0,n.useState)(C),[q,R]=(0,n.useState)(E),[D,U]=(0,n.useState)(P),[L,O]=(0,n.useState)(v||null),[Y,G]=(0,n.useState)({}),I=(e,t)=>{k(a=>({...a,[e]:t})),Y[e]&&G(t=>{let a={...t};return delete a[e],a})},J=async e=>{e.preventDefault();let t={name:S.name.trim(),lastName:S.lastName.trim(),email:S.email.trim(),phoneNumber:S.phoneNumber||"",billingAddress:S.billingAddress||"",billingAddress2:l.billingAddress2||"",postalCode:S.postalCode||"",idCountry:A||0,idProvince:q||0,idCity:D||0,idRole:(null==L?void 0:L.id)||0},a=w?{...t,password:S.password}:t,r=(w?m:p).safeParse(a);if(!r.success){let e={};r.error.errors.forEach(t=>{let a=t.path[0];a&&(e[a]=t.message)}),G(e);let t=Object.values(e).join("\n");alert("Por favor, corrige los siguientes errores:\n\n".concat(t));return}G({});let n={name:a.name,lastName:a.lastName,email:a.email,phoneNumber:a.phoneNumber,billingAddress:a.billingAddress,billingAddress2:a.billingAddress2,postalCode:a.postalCode,idCountry:Number(a.idCountry)||0,idProvince:Number(a.idProvince)||0,idCity:Number(a.idCity)||0,idRole:Number(a.idRole)||0};w&&S.password&&(n.password=S.password),console.log("\uD83D\uDD0D Valores del formulario antes de enviar:",{selectedCountryId:A,selectedProvinceId:q,selectedCityId:D,selectedRole:L,userData:n}),await u(n)};return(0,r.jsxs)("form",{onSubmit:J,className:"p-8 space-y-8",children:[(b||f)&&(0,r.jsxs)("div",{className:"border-b border-gray-700 pb-6",children:[b&&(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:b}),f&&(0,r.jsx)("p",{className:"text-gray-400 mt-1",children:f})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-6",children:"Informaci\xf3n Personal"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(o.p,{name:"name",label:"Nombre",value:S.name,onChange:e=>I("name",e),required:!0,error:Y.name}),(0,r.jsx)(o.p,{name:"lastName",label:"Apellido",value:S.lastName,onChange:e=>I("lastName",e),required:!0,error:Y.lastName}),(0,r.jsx)(o.p,{name:"email",label:"Email",type:"email",value:S.email,onChange:e=>I("email",e),required:!0,error:Y.email}),w&&(0,r.jsx)(o.p,{name:"password",label:"Contrase\xf1a",type:"password",value:S.password,onChange:e=>I("password",e),required:!0,autoComplete:"new-password",error:Y.password}),(0,r.jsx)(o.p,{name:"phoneNumber",label:"Tel\xe9fono",type:"tel",value:S.phoneNumber,onChange:e=>I("phoneNumber",e)})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-6",children:"Direcci\xf3n de Facturaci\xf3n"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(o.p,{name:"billingAddress",label:"Direcci\xf3n",value:S.billingAddress,onChange:e=>I("billingAddress",e)}),(0,r.jsx)(c,{initialCountryId:A,initialProvinceId:q,initialCityId:D,onCountryChange:e=>{T(e),Y.idCountry&&G(e=>{let t={...e};return delete t.idCountry,t})},onProvinceChange:e=>{R(e),Y.idProvince&&G(e=>{let t={...e};return delete t.idProvince,t})},onCityChange:e=>{U(e),Y.idCity&&G(e=>{let t={...e};return delete t.idCity,t})},disabled:d,required:!0,countryError:Y.idCountry,provinceError:Y.idProvince,cityError:Y.idCity}),(0,r.jsx)(o.p,{name:"postalCode",label:"C\xf3digo Postal",value:S.postalCode,onChange:e=>I("postalCode",e)})]})]}),x&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-6",children:"Rol de Usuario"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-300",children:["Rol ",(0,r.jsx)("span",{className:"text-violet-400",children:"*"})]}),(0,r.jsxs)("select",{name:"role",value:(null==L?void 0:L.id)||"",onChange:e=>{let t=Number(e.target.value);O(j.find(e=>e.id===t)||null),Y.idRole&&G(e=>{let t={...e};return delete t.idRole,t})},disabled:d,className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all disabled:opacity-50 ".concat(Y.idRole?"border-red-500 focus:ring-red-500":"border-gray-600"),children:[(0,r.jsx)("option",{value:"",className:"bg-gray-700",children:"Seleccione..."}),j.map(e=>(0,r.jsx)("option",{value:e.id,className:"bg-gray-700",children:e.name},String(e.id)))]}),Y.idRole&&(0,r.jsx)("p",{role:"alert",className:"text-sm text-red-400 mt-1",children:Y.idRole})]})]}),N,(0,r.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-700",children:[(0,r.jsx)(s.$,{type:"button",onClick:h,disabled:d,variant:"secondary",children:y}),(0,r.jsx)(s.$,{type:"submit",loading:d,disabled:d,children:d?"Guardando...":g})]})]})}}}]);
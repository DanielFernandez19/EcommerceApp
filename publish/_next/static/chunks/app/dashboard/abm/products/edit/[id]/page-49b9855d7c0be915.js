(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[316],{769:(e,t,a)=>{"use strict";a.d(t,{default:()=>d});var r=a(5155),c=a(2115),n=a(5695),o=a(3990),s=a(8316),l=a(9509);function i(e){let{productId:t,images:a,onChange:c}=e,n=async e=>{var a;(null===(a=e.target.files)||void 0===a?void 0:a[0])&&(await (0,s.iG)(t,e.target.files[0]),c())},o=async e=>{await (0,s.Us)(e),c()};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsxs)("label",{className:"bg-blue-600 text-white px-4 py-2 rounded cursor-pointer hover:bg-blue-700 transition",children:["Seleccionar imagen",(0,r.jsx)("input",{type:"file",className:"hidden",onChange:n})]})}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-4",children:a.map(e=>(0,r.jsxs)("div",{className:"relative aspect-square",children:[(0,r.jsx)("img",{src:"".concat(l.env.NEXT_PUBLIC_STATIC_URL).concat(e.imageUrl),alt:"Producto",className:"rounded w-full h-full object-cover"}),(0,r.jsx)("button",{onClick:()=>o(e.id),className:"absolute top-1 right-1 bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700 transition",children:"X"})]},e.id))})]})}function d(e){let{id:t}=e,a=(0,n.useRouter)(),[s,l]=(0,c.useState)(null),[d,u]=(0,c.useState)(!0);(0,c.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("http://localhost:5000/api","/products/").concat(t));if(e.ok){let t=await e.json();l(t)}}catch(e){console.error("Error loading product:",e)}finally{u(!1)}};t&&e()},[t]);let h=async e=>{try{(await fetch("".concat("http://localhost:5000/api","/products/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&a.push("/dashboard/abm/products")}catch(e){console.error("Error updating product:",e)}};return d?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("p",{className:"text-white",children:"Cargando producto..."})}):s?(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(o.A,{initialData:s,submitLabel:"Guardar cambios",onSubmit:h})}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(i,{productId:s.id,images:s.images||[],onChange:()=>{fetch("".concat("http://localhost:5000/api","/products/").concat(t)).then(e=>e.json()).then(l)}})})]}):(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("p",{className:"text-white",children:"Producto no encontrado"})})}},3990:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(5155),c=a(2115),n=a(8316);function o(e){var t,a,o,s,l;let{initialData:i,onSubmit:d,submitLabel:u}=e,[h,p]=(0,c.useState)({name:null!==(t=null==i?void 0:i.name)&&void 0!==t?t:"",description:null!==(a=null==i?void 0:i.description)&&void 0!==a?a:"",price:null!==(o=null==i?void 0:i.price)&&void 0!==o?o:0,stock:null!==(s=null==i?void 0:i.stock)&&void 0!==s?s:0,categoryId:null!==(l=null==i?void 0:i.categoryId)&&void 0!==l?l:1}),[y,m]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{try{let e=await (0,n.bW)();m(e),(null==i?void 0:i.categoryId)||!(e.length>0)||p(t=>({...t,categoryId:e[0].id}))}catch(e){console.error("Error al cargar categor\xedas:",e)}finally{g(!1)}})()},[i]);let x=e=>{let{name:t,value:a}=e.target;p({...h,[t]:a})},b=async e=>{e.preventDefault(),await d({...h,price:Number(h.price),stock:Number(h.stock),categoryId:Number(h.categoryId),storeId:1})};return(0,r.jsxs)("form",{onSubmit:b,className:"bg-gray-800 border border-gray-700 rounded-xl p-6 space-y-5 max-w-xl",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white",children:u}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-gray-400",children:"Nombre del producto"}),(0,r.jsx)("input",{name:"name",value:h.name,onChange:x,className:"w-full p-2 rounded bg-gray-900 text-white border border-gray-700",placeholder:"Ej: Remera oversize",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-gray-400",children:"Descripci\xf3n"}),(0,r.jsx)("textarea",{name:"description",value:h.description,onChange:x,className:"w-full p-2 rounded bg-gray-900 text-white border border-gray-700",placeholder:"Detalle del producto",rows:3})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-gray-400",children:"Precio"}),(0,r.jsx)("input",{type:"number",name:"price",value:h.price,onChange:x,className:"w-full p-2 rounded bg-gray-900 text-white border border-gray-700",placeholder:"Ej: 19999",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-gray-400",children:"Stock disponible"}),(0,r.jsx)("input",{type:"number",name:"stock",value:h.stock,onChange:x,className:"w-full p-2 rounded bg-gray-900 text-white border border-gray-700",placeholder:"Ej: 10",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-gray-400",children:"Categor\xeda"}),f?(0,r.jsx)("div",{className:"w-full p-2 rounded bg-gray-900 text-gray-400 border border-gray-700",children:"Cargando categor\xedas..."}):(0,r.jsx)("select",{name:"categoryId",value:h.categoryId,onChange:x,className:"w-full p-2 rounded bg-gray-900 text-white border border-gray-700 focus:outline-none focus:border-violet-500",required:!0,children:y.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,r.jsx)("button",{type:"submit",className:"w-full bg-violet-600 hover:bg-violet-700 text-white py-2 rounded-lg transition",children:u})]})}},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},8316:(e,t,a)=>{"use strict";async function r(){try{let e=await fetch("".concat("http://localhost:5000/api","/products"));return e.ok?await e.json():[]}catch(e){return[]}}async function c(){try{let e=await fetch("".concat("http://localhost:5000/api","/order"));return e.ok?await e.json():[]}catch(e){return[]}}async function n(e){try{let t=await fetch("".concat("http://localhost:5000/api","/order/user/").concat(e));return t.ok?await t.json():[]}catch(e){return[]}}a.d(t,{DD:()=>h,Kv:()=>m,TK:()=>u,Us:()=>y,WF:()=>c,WY:()=>o,bW:()=>d,d$:()=>r,ht:()=>l,iG:()=>p,kg:()=>s,mq:()=>n,xw:()=>i});async function o(e){try{let t=await fetch("".concat("http://localhost:5000/api","/products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t.ok?await t.json():null}catch(e){return null}}async function s(e){try{return(await fetch("".concat("http://localhost:5000/api","/user/CreateUser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok}catch(e){return!1}}async function l(e){try{let t=await fetch("".concat("http://localhost:5000/api","/user/GetAll"));if(!t.ok)return null;return(await t.json()).find(t=>t.email===e)}catch(e){return null}}async function i(e,t){try{return(await fetch("".concat("http://localhost:5000/api","/user/UpdatePass"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({Id:e,newPassword:t})})).ok}catch(e){return!1}}async function d(){try{let e=await fetch("".concat("http://localhost:5000/api","/Products/GetCategories"));return e.ok?await e.json():[]}catch(e){return[]}}async function u(e,t){try{return(await fetch("".concat("http://localhost:5000/api","/user/UpdateUser"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok}catch(e){return!1}}async function h(e){try{return(await fetch("".concat("http://localhost:5000/api","/products/").concat(e),{method:"DELETE"})).ok}catch(e){return!1}}async function p(e,t){try{let a=new FormData;a.append("file",t);let r=await fetch("".concat("http://localhost:5000/api","/products/").concat(e,"/images"),{method:"POST",body:a});return r.ok?await r.json():null}catch(e){return null}}async function y(e){try{return(await fetch("".concat("http://localhost:5000/api","/products/images/").concat(e),{method:"DELETE"})).ok}catch(e){return!1}}async function m(e,t){try{return(await fetch("".concat("http://localhost:5000/api","/order/").concat(e,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok}catch(e){return!1}}},8627:(e,t,a)=>{Promise.resolve().then(a.bind(a,769))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(8627)),_N_E=e.O()}]);
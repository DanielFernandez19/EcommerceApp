"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[891],{2488:(t,e,a)=>{a.d(e,{AuthenticationProvider:()=>i,Z:()=>s});var o=a(5155),r=a(2115),n=a(5695);let c=(0,r.createContext)(void 0);function i(t){let{children:e}=t,[a,i]=(0,r.useState)(null),[s,l]=(0,r.useState)(!0),u=(0,n.useRouter)(),d=()=>{let t="; ".concat(document.cookie).split("; auth_token=");if(2===t.length){var e;return(null===(e=t.pop())||void 0===e?void 0:e.split(";").shift())||null}return null},h=()=>{let t="; ".concat(document.cookie).split("; auth_user=");if(2===t.length)try{var e;let a=null===(e=t.pop())||void 0===e?void 0:e.split(";").shift();if(a)return JSON.parse(decodeURIComponent(a))}catch(t){console.error("Error parsing auth_user cookie:",t)}return null};(0,r.useEffect)(()=>{(async()=>{try{if(d()){let t=h();t?i(t):(i(null),u.push("/Login"))}}catch(t){console.error("Error en inicializaci\xf3n:",t),i(null)}finally{l(!1)}})()},[]);let p=!!a,f=!!a&&[1,2].includes(a.idRole);return(0,o.jsx)(c.Provider,{value:{user:a,isAuthenticated:p,isAdmin:f,initializing:s,setUser:i,logout:()=>{document.cookie="auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="auth_user=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",localStorage.removeItem("auth"),i(null),u.push("/Login")},refreshAuth:()=>{if(d()){let t=h();t?i(t):(i(null),u.push("/Login"))}else i(null)}},children:e})}function s(){let t=(0,r.useContext)(c);if(void 0===t)throw Error("useAuthContext must be used within an AuthenticationProvider");return t}},3024:(t,e,a)=>{a.d(e,{AR:()=>i,Jn:()=>s,Mr:()=>n,SM:()=>c,Xl:()=>r});let o="http://localhost:5000/api";async function r(t){let e=await fetch("".concat(o,"/Cart/GetCart/").concat(t),{cache:"no-store"});if(!e.ok)throw Error("Error al obtener carrito");return e.json()}async function n(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=await fetch("".concat(o,"/Cart/AddItemToCart"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,productId:e,quantity:a})});if(console.log("AddItem payload:",{userId:t,productId:e,quantity:a}),!r.ok)throw Error("Error al agregar producto");return r.json()}async function c(t){if(!(await fetch("".concat(o,"/Cart/RemoveCartItem/").concat(t),{method:"DELETE"})).ok)throw Error("Error al eliminar item")}async function i(t,e){let a=await fetch("".concat(o,"/Cart/UpdateCartItemQuantity/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("Error al actualizar cantidad");return a.json()}async function s(t){let e=await fetch("".concat(o,"/Order/CreateOrder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t})});if(!e.ok)throw Error((await e.json().catch(()=>({}))).message||"Error al confirmar pedido");return e.json()}},3072:(t,e,a)=>{a.d(e,{A:()=>s});var o=a(5155),r=a(2115),n=a(3676),c=a(2488);function i(t){var e,a,i,s,l;let{product:u}=t,[d,h]=(0,r.useState)(!1),p="http://localhost:5000/api".replace("/api",""),f=(null===(a=u.images)||void 0===a?void 0:null===(e=a[0])||void 0===e?void 0:e.imageUrl)?"".concat(p).concat(u.images[0].imageUrl):"/placeholder.png",{addProduct:m,cart:y,loadCart:g}=(0,n.x)(),{user:x}=(0,c.Z)(),w=x&&1!==x.idRole;(0,r.useEffect)(()=>{x&&g(x.id)},[x,g]),(0,r.useEffect)(()=>{(null==y?void 0:y.items)&&Array.isArray(y.items)?h(y.items.some(t=>t.productId===u.id||t.idProduct===u.id)):h(!1)},[y,u.id]);let v=async()=>{if(x)try{await m(x.id,u.id),h(!0)}catch(t){console.error("Error al agregar al carrito:",t)}};return(0,o.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-lg overflow-hidden hover:border-violet-500 transition-all duration-300 group relative",children:[(0,o.jsxs)("div",{className:"relative h-64 overflow-hidden bg-gray-800",children:[(0,o.jsx)("img",{src:f,alt:null!==(i=u.name)&&void 0!==i?i:"Producto",className:"w-full h-full object-cover"}),u.stock>0&&u.stock<=10&&(0,o.jsxs)("div",{className:"absolute top-2 right-2 bg-red-600 text-white px-2 py-1 text-xs rounded-full",children:["\xa1\xdaltimas ",u.stock," unidades!"]}),0===u.stock&&(0,o.jsx)("div",{className:"absolute top-2 right-2 bg-gray-700 text-white px-2 py-1 text-xs rounded-full",children:"Sin stock"})]}),(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsx)("h3",{className:"font-semibold text-lg text-white mb-2 line-clamp-1",children:null!==(s=u.name)&&void 0!==s?s:"Sin nombre"}),(0,o.jsx)("p",{className:"text-gray-400 text-sm mb-3 line-clamp-2",children:null!==(l=u.description)&&void 0!==l?l:""}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("span",{className:"text-2xl font-bold text-violet-400",children:["$",u.price.toLocaleString("es-AR")]}),(0,o.jsx)("span",{className:"text-xs text-gray-500 ml-1",children:"ARS"})]}),d?(0,o.jsxs)("div",{className:"px-4 py-2 rounded-md text-sm font-medium bg-green-600 text-white flex items-center gap-2",children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"En carrito"]}):(0,o.jsx)("button",{disabled:0===u.stock||!x||!w,onClick:v,className:"px-4 py-2 rounded-md text-sm font-medium transition-colors\n                ".concat(0!==u.stock&&x&&w?"bg-violet-600 text-white hover:bg-violet-700":"bg-gray-700 text-gray-400 cursor-not-allowed"),children:"Agregar"})]})]})]})}function s(t){let{products:e,title:a}=t;return 0===e.length?(0,o.jsx)("div",{className:"text-center py-12",children:(0,o.jsx)("p",{className:"text-gray-400 text-lg",children:"No hay productos disponibles"})}):(0,o.jsxs)("section",{className:"py-12",children:[a&&(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("h2",{className:"text-3xl font-bold text-white mb-4",children:a}),(0,o.jsx)("div",{className:"w-24 h-1 bg-violet-500 mx-auto"})]}),(0,o.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.map(t=>(0,o.jsx)(i,{product:t},t.id))})]})}},3676:(t,e,a)=>{a.d(e,{x:()=>l});var o=a(2115);let r=t=>{let e;let a=new Set,o=(t,o)=>{let r="function"==typeof t?t(e):t;if(!Object.is(r,e)){let t=e;e=(null!=o?o:"object"!=typeof r||null===r)?r:Object.assign({},e,r),a.forEach(a=>a(e,t))}},r=()=>e,n={setState:o,getState:r,getInitialState:()=>c,subscribe:t=>(a.add(t),()=>a.delete(t))},c=e=t(o,r,n);return n},n=t=>t?r(t):r,c=t=>t,i=t=>{let e=n(t),a=t=>(function(t,e=c){let a=o.useSyncExternalStore(t.subscribe,o.useCallback(()=>e(t.getState()),[t,e]),o.useCallback(()=>e(t.getInitialState()),[t,e]));return o.useDebugValue(a),a})(e,t);return Object.assign(a,e),a};var s=a(3024);let l=(t=>t?i(t):i)(t=>({cart:null,loading:!1,loadCart:async e=>{t({loading:!0}),t({cart:await (0,s.Xl)(e),loading:!1})},addProduct:async(e,a)=>{await (0,s.Mr)(e,a,1),t({cart:await (0,s.Xl)(e)})},removeItem:async(e,a)=>{await (0,s.SM)(a),t({cart:await (0,s.Xl)(e)})},updateQuantity:async(e,a,o)=>{!(o<1)&&(await (0,s.AR)(a,o),t({cart:await (0,s.Xl)(e)}))}}))},5695:(t,e,a)=>{var o=a(8999);a.o(o,"usePathname")&&a.d(e,{usePathname:function(){return o.usePathname}}),a.o(o,"useRouter")&&a.d(e,{useRouter:function(){return o.useRouter}})},8316:(t,e,a)=>{async function o(){try{let t=await fetch("".concat("http://localhost:5000/api","/products"));return t.ok?await t.json():[]}catch(t){return[]}}async function r(){try{let t=await fetch("".concat("http://localhost:5000/api","/order"));return t.ok?await t.json():[]}catch(t){return[]}}async function n(t){try{let e=await fetch("".concat("http://localhost:5000/api","/order/user/").concat(t));return e.ok?await e.json():[]}catch(t){return[]}}a.d(e,{DD:()=>h,Kv:()=>m,TK:()=>d,Us:()=>f,WF:()=>r,WY:()=>c,bW:()=>u,d$:()=>o,ht:()=>s,iG:()=>p,kg:()=>i,mq:()=>n,xw:()=>l});async function c(t){try{let e=await fetch("".concat("http://localhost:5000/api","/products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.ok?await e.json():null}catch(t){return null}}async function i(t){try{return(await fetch("".concat("http://localhost:5000/api","/user/CreateUser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok}catch(t){return!1}}async function s(t){try{let e=await fetch("".concat("http://localhost:5000/api","/user/GetAll"));if(!e.ok)return null;return(await e.json()).find(e=>e.email===t)}catch(t){return null}}async function l(t,e){try{return(await fetch("".concat("http://localhost:5000/api","/user/UpdatePass"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({Id:t,newPassword:e})})).ok}catch(t){return!1}}async function u(){try{let t=await fetch("".concat("http://localhost:5000/api","/Products/GetCategories"));return t.ok?await t.json():[]}catch(t){return[]}}async function d(t,e){try{return(await fetch("".concat("http://localhost:5000/api","/user/UpdateUser"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok}catch(t){return!1}}async function h(t){try{return(await fetch("".concat("http://localhost:5000/api","/products/").concat(t),{method:"DELETE"})).ok}catch(t){return!1}}async function p(t,e){try{let a=new FormData;a.append("file",e);let o=await fetch("".concat("http://localhost:5000/api","/products/").concat(t,"/images"),{method:"POST",body:a});return o.ok?await o.json():null}catch(t){return null}}async function f(t){try{return(await fetch("".concat("http://localhost:5000/api","/products/images/").concat(t),{method:"DELETE"})).ok}catch(t){return!1}}async function m(t,e){try{return(await fetch("".concat("http://localhost:5000/api","/order/").concat(t,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})})).ok}catch(t){return!1}}}}]);